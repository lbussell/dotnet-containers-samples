{
  "$schema": "http://json.schemastore.org/template",
  "author": "Logan Bussell",
  "classifications": ["Console"],
  "name": "Containerized Console App",
  "identity": "Microsoft.DotNet.Containers.Samples.Templates.ConsoleApp",
  "shortName": "container-console",
  "tags": {
    "language": "C#",
    "type":"project"
  },
  "sourceName": "ConsoleApp",
  "preferNameDirectory": true,
  "symbols": {
    "description": {
      "type": "parameter",
      "datatype": "string",
      "defaultValue": "",
      "replaces": "DESCRIPTION",
      "description": "A short description of the application"
    },
    "self-contained": {
      "type": "parameter",
      "datatype": "bool",
      "defaultValue": "false",
      "description": "Enable self-contained publishing with trimming and ReadyToRun"
    },
    "aot": {
      "type": "parameter",
      "datatype": "bool",
      "defaultValue": "false",
      "description": "Enable Native AOT compilation for fastest startup and smallest size"
    },
    "distroless": {
      "type": "parameter",
      "datatype": "bool",
      "defaultValue": "false",
      "description": "Use distroless runtime base images for minimal attack surface"
    },
    "baseImageOS": {
      "type": "parameter",
      "datatype": "choice",
      "defaultValue": "noble",
      "replaces": "BASE_IMAGE_OS",
      "choices": [
        {
          "choice": "noble",
          "description": "Ubuntu 24.04 (Noble)"
        },
        {
          "choice": "alpine",
          "description": "Alpine Linux"
        },
        {
          "choice": "azurelinux",
          "description": "Azure Linux 3.0"
        },
        {
          "choice": "nanoserver",
          "description": "Windows Nano Server LTSC 2022"
        }
      ],
      "description": "The base image OS for the container"
    },
    "baseImageTag": {
      "type": "generated",
      "generator": "switch",
      "replaces": "BASE_IMAGE_TAG",
      "parameters": {
        "evaluator": "C++",
        "datatype": "string",
        "cases": [
          {
            "condition": "(baseImageOS == 'noble' && distroless)",
            "value": "10.0-noble-chiseled"
          },
          {
            "condition": "(baseImageOS == 'noble' && !distroless)",
            "value": "10.0-noble"
          },
          {
            "condition": "(baseImageOS == 'alpine')",
            "value": "10.0-alpine"
          },
          {
            "condition": "(baseImageOS == 'azurelinux' && distroless)",
            "value": "10.0-azurelinux3.0-distroless"
          },
          {
            "condition": "(baseImageOS == 'azurelinux' && !distroless)",
            "value": "10.0-azurelinux3.0"
          },
          {
            "condition": "(baseImageOS == 'nanoserver')",
            "value": "10.0-nanoserver-ltsc2022"
          }
        ]
      }
    },
    "baseImageRepo": {
      "type": "generated",
      "generator": "switch",
      "replaces": "BASE_IMAGE_REPO",
      "parameters": {
        "evaluator": "C++",
        "datatype": "string",
        "cases": [
          {
            "condition": "(self-contained || aot)",
            "value": "runtime-deps"
          },
          {
            "condition": "(!self-contained && !aot)",
            "value": "runtime"
          }
        ]
      }
    },
    "sdkImageTag": {
      "type": "generated",
      "generator": "switch",
      "replaces": "SDK_IMAGE_TAG",
      "parameters": {
        "evaluator": "C++",
        "datatype": "string",
        "cases": [
          {
            "condition": "(aot && baseImageOS == 'noble')",
            "value": "10.0-noble-aot"
          },
          {
            "condition": "(aot && baseImageOS == 'alpine')",
            "value": "10.0-alpine-aot"
          },
          {
            "condition": "(aot && baseImageOS == 'azurelinux')",
            "value": "10.0-azurelinux3.0-aot"
          },
          {
            "condition": "(!aot && baseImageOS == 'noble')",
            "value": "10.0-noble"
          },
          {
            "condition": "(!aot && baseImageOS == 'alpine')",
            "value": "10.0-alpine"
          },
          {
            "condition": "(!aot && baseImageOS == 'azurelinux')",
            "value": "10.0-azurelinux3.0"
          },
          {
            "condition": "(baseImageOS == 'nanoserver')",
            "value": "10.0-nanoserver-ltsc2022"
          }
        ]
      }
    },
    "selfContainedValue": {
      "type": "generated",
      "generator": "switch",
      "replaces": "SELF_CONTAINED_VALUE",
      "parameters": {
        "evaluator": "C++",
        "datatype": "string",
        "cases": [
          {
            "condition": "(self-contained)",
            "value": "true"
          },
          {
            "condition": "(!self-contained)",
            "value": "false"
          }
        ]
      }
    },
    "aotValue": {
      "type": "generated",
      "generator": "switch",
      "replaces": "AOT_VALUE",
      "parameters": {
        "evaluator": "C++",
        "datatype": "string",
        "cases": [
          {
            "condition": "(aot)",
            "value": "true"
          },
          {
            "condition": "(!aot)",
            "value": "false"
          }
        ]
      }
    },
    "distrolessValue": {
      "type": "generated",
      "generator": "switch",
      "replaces": "DISTROLESS_VALUE",
      "parameters": {
        "evaluator": "C++",
        "datatype": "string",
        "cases": [
          {
            "condition": "(distroless)",
            "value": "true"
          },
          {
            "condition": "(!distroless)",
            "value": "false"
          }
        ]
      }
    }
  },
  "postActions": [
    {
      "condition": "(self-contained && aot)",
      "description": "Error: self-contained and aot options are mutually exclusive",
      "manualInstructions": [
        {
          "text": "Cannot use both --self-contained and --aot options together. Please choose one."
        }
      ],
      "actionId": "3A7C4B45-1F5D-4A30-959A-51B88E82B5D2",
      "continueOnError": false
    },
    {
      "condition": "(aot && baseImageOS == 'nanoserver')",
      "description": "Error: Native AOT is not supported on nanoserver",
      "manualInstructions": [
        {
          "text": "Native AOT compilation is not supported on Windows Nano Server. Please choose a different base OS (noble, alpine, or azurelinux)."
        }
      ],
      "actionId": "3A7C4B45-1F5D-4A30-959A-51B88E82B5D3",
      "continueOnError": false
    },
    {
      "condition": "(distroless && baseImageOS != 'noble' && baseImageOS != 'azurelinux')",
      "description": "Error: Distroless images are only available for noble and azurelinux",
      "manualInstructions": [
        {
          "text": "Distroless images are only available for Ubuntu Noble (noble) and Azure Linux (azurelinux). Please choose one of these base OS options."
        }
      ],
      "actionId": "3A7C4B45-1F5D-4A30-959A-51B88E82B5D4",
      "continueOnError": false
    }
  ]
}